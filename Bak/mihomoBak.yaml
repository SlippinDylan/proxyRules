# å—…æ¢é…ç½®
sniffer:
  enable: true
  # ç«¯å£å—…æ¢è®¾ç½®
  sniff: {
    HTTP: {ports: [80, 8080-8880], override-destination: true},
    TLS: {ports: [443, 8443], override-destination: true},
    QUIC: {ports: [443, 8443], override-destination: true}
  }
  force-domain: ["+.v2ex.com"]
  skip-domain: [
    # "rule-set:category_media_cn_domain,chinamedia_domain,gamedownloadcn_domain,category_games_cn_domain,aliyun_domain,alibaba_domain,tencent_domain,xiaomi_domain,xiaohongshu_domain,cn_domain,usr_direct,private_domain,direct_torrent", 
    "rule-set:category_media_cn_domain,chinamedia_domain,gamedownloadcn_domain,category_games_cn_domain,cn_domain,usr_direct,private_domain,direct_torrent", 
    "+.push.apple.com", "+.apple.com", "+.wechat.com", "start.me","+.start.me",
    "+.qpic.cn", "+.wechatapp.com", "+.vivox.com", "+.oray.com", "+.sunlogin.net", 
    "+.msftconnecttest.com", "+.msftncsi.com", "Mijia Cloud", 
    "+.tsinghua.edu.cn"
  ]

# DNSæ¨¡å—
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  respect-rules: true
  enable-dnssec: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-cache: true
  fake-ip-filter-mode: blacklist
  fake-ip-filter: [
    # "rule-set:category_media_cn_domain,chinamedia_domain,gamedownloadcn_domain,category_games_cn_domain,aliyun_domain,alibaba_domain,tencent_domain,xiaomi_domain,xiaohongshu_domain,cn_domain,usr_direct,private_domain,direct_torrent,docker_domain,category_dev_domain,develousr_domain,linux_domain,usr_proxy_develop", 
    "rule-set:category_media_cn_domain,chinamedia_domain,gamedownloadcn_domain,category_games_cn_domain,cn_domain,usr_direct,private_domain,direct_torrent,docker_domain,category_dev_domain,develousr_domain,linux_domain,usr_proxy_develop", 
    "+.services.googleapis.cn", "+.xn--ngstr-lra8j.com", 
    "+.ntp.tencent.com", "+.ntp1.aliyun.com", "time.*.com", 
    "+.ntp.ntsc.ac.cn", "+.pool.ntp.org", "+.cn.ntp.org.cn", 
    "+.yarnpkg.com", "+.ustclug.org",
    "start.me","+.start.me",
    "+.lan", "+.local", "geosite:cn", 
    "mirrors.vsean.net", "+.vsean.net"
    
  ]
  # DNSæœåŠ¡å™¨é…ç½®
  default-nameserver: &cn_dns [119.29.29.29, 223.5.5.5, '2400:3200::1', '2402:4e00::']
  proxy-server-nameserver: *cn_dns
  nameserver: *cn_dns
  nameserver-policy: {
    "+.github.com": [8.8.8.8, 1.1.1.1], "github.com": [8.8.8.8, 1.1.1.1], 
    "+.githubusercontent.com": [8.8.8.8, 1.1.1.1],
    "+.debian.org": [8.8.8.8, 1.1.1.1], "+.yarnpkg.com": [8.8.8.8, 1.1.1.1], 
    "+.ustclug.org": [8.8.8.8, 1.1.1.1], "+.immortalwrt.org": [8.8.8.8, 1.1.1.1], 
    "+.openwrt.org": [8.8.8.8, 1.1.1.1], "+.vsean.net": [8.8.8.8, 1.1.1.1]
  }

  # äº’è”ç½‘å·¨å¤´æœåŠ¡(å›½å†…)
  # - RULE-SET,aliyun_domain,å›½å†…ç›´è¿
  # - RULE-SET,alibaba_domain,å›½å†…ç›´è¿
  # - RULE-SET,tencent_domain,å›½å†…ç›´è¿
  # - RULE-SET,xiaomi_domain,å›½å†…ç›´è¿
  # - RULE-SET,xiaohongshu_domain,å›½å†…ç›´è¿




  #hk: &hk_filter "(?i)(?=.*(é¦™æ¸¯|HK|Hong Kong|HongKong|ğŸ‡­ğŸ‡°))(?!.*(ç¦åˆ©|æ–°ç”¨æˆ·|é‚€è¯·|ç½‘å€|com|0\\.[1-9]|([2-9](\\.\\d+)?å€)|([1-9]\\då€)))"
  #tw: &tw_filter "(?i)(?=.*(å°æ¹¾|TW|TWN|Taiwan|Taipei|HiNet|Taoyuan|Tainan|Taichung|ğŸ‡¹ğŸ‡¼))(?!.*(ç¦åˆ©|æ–°ç”¨æˆ·|é‚€è¯·|ç½‘å€|com|0\\.[1-9]|([2-9](\\.\\d+)?å€)|([1-9]\\då€)))"
  #jp: &jp_filter "(?i)(?=.*(æ—¥æœ¬|JP|Japan|Tokyo|ğŸ‡¯ğŸ‡µ))(?!.*(ç¦åˆ©|æ–°ç”¨æˆ·|é‚€è¯·|ç½‘å€|com|0\\.[1-9]|([2-9](\\.\\d+)?å€)|([1-9]\\då€)))"
  #sg: &sg_filter "(?i)(?=.*(æ–°åŠ å¡|ç‹®åŸ|Singapore|SG|ğŸ‡¸ğŸ‡¬))(?!.*(ç¦åˆ©|æ–°ç”¨æˆ·|é‚€è¯·|ç½‘å€|com|0\\.[1-9]|([2-9](\\.\\d+)?å€)|([1-9]\\då€)))"
  # - {name: Synology, <<: *directmain}
  # - {name: ğŸ¶ TikTok, type: select, proxies: [ğŸ‡ºğŸ‡¸ ç¾å›½è‡ªåŠ¨, ğŸŒ äºšæ´²è‡ªåŠ¨]}
  # - {name: ğŸŒ äºšæ´²è‡ªåŠ¨, type: url-test, use: [flyingBird], interval: 60, tolerance: 10, filter: *as_filter}
  # - {name: ğŸ‡­ğŸ‡° é¦™æ¸¯è‡ªåŠ¨, type: url-test, use: [flyingBird], interval: 60, tolerance: 10, filter: *hk_filter}
  # - {name: ğŸ‡¹ğŸ‡¼ å°æ¹¾è‡ªåŠ¨, type: url-test, use: [flyingBird], interval: 60, tolerance: 10, filter: *tw_filter}
  # - {name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬è‡ªåŠ¨, type: url-test, use: [flyingBird], interval: 60, tolerance: 10, filter: *jp_filter}
  # - {name: ğŸ‡¸ğŸ‡¬ ç‹®åŸè‡ªåŠ¨, type: url-test, use: [flyingBird], interval: 60, tolerance: 10, filter: *sg_filter}
  # - {name: ğŸ¤– AIè‡ªåŠ¨, type: url-test, use: [flyingBird], interval: 60, tolerance: 10, filter: *ai_filter}
  # - {name: ğŸ§± å¤‡ä»½èŠ‚ç‚¹, type: fallback, use: [bocchi, yiYuan], interval: 60, tolerance: 10, filter: *bak_filter}
  
  
  # äº’è”ç½‘å·¨å¤´æœåŠ¡ï¼ˆå›½å†…ï¼‰
#aliyun_domain:
#<<: *domain
#url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/aliyun.mrs"
#alibaba_domain:
#<<: *domain
#url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/alibaba.mrs"
#tencent_domain:
#<<: *domain
#url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tencent.mrs"
#xiaomi_domain:
#<<: *domain
#url: "https://gh-proxy.com/raw.githubusercontent.com/peiyingyao/Rule-for-OCD/master/rule/Clash/XiaoMi/XiaoMi_OCD_Domain.mrs"
#xiaohongshu_domain:
#<<: *domain
#url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/xiaohongshu.mrs"


#ntp:
#  enable: true
#  # æ˜¯å¦åŒæ­¥è‡³ç³»ç»Ÿæ—¶é—´ï¼Œéœ€è¦ root/ç®¡ç†å‘˜æƒé™
#  write-to-system: false
#  server: time.apple.com
#  port: 123
#  interval: 30

# DNSæ¨¡å—
# dns:
# æ·»åŠ é¢„çƒ­é…ç½®
# preload-domain: true
# preload-domain-task: 15
# name-resolve-format: ipv4-only  # å¦‚æœåªéœ€è¦IPv4åœ°å€

# æ·»åŠ é¢„è§£æåŸŸå
# use-hosts: true
# prefetch-domain: true
# prefer-h3: false

# DNSæ¨¡å—
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  respect-rules: true
  # enable-dnssec: true
  doh-priority-http3: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-cache: true
  fake-ip-filter-mode: blacklist
  fake-ip-filter: [
    "rule-set:category_media_cn_domain,chinamedia_domain,gamedownloadcn_domain,category_games_cn_domain,cn_domain,usr_direct,private_domain,usr_direct_torrent,docker_domain,category_dev_domain,develousr_domain,linux_domain,usr_proxy_develop", 
    "+.services.googleapis.cn", "+.xn--ngstr-lra8j.com", 
    "+.ntp.tencent.com", "+.ntp1.aliyun.com", "time.*.com", "+.ntp.ntsc.ac.cn", "+.pool.ntp.org", "+.cn.ntp.org.cn", 
    "+.yarnpkg.com", "+.ustclug.org",
    "start.me","+.start.me",
    "+.lan", "+.local", "geosite:cn", 
    "mirrors.vsean.net", "+.vsean.net", "+.slippindylan.com"
  ]
  # DNSæœåŠ¡å™¨é…ç½®
  default-nameserver: [223.5.5.5, 119.29.29.29, 2402:4e00::, 2400:3200::1]
  proxy-server-nameserver: [223.5.5.5, 119.29.29.29]
  nameserver: [223.5.5.5, 119.29.29.29]
  nameserver-policy: {
    "+.github.com": [8.8.8.8, 1.1.1.1], "github.com": [8.8.8.8, 1.1.1.1], 
    "+.githubusercontent.com": [8.8.8.8, 1.1.1.1],
    "+.debian.org": [8.8.8.8, 1.1.1.1], "+.yarnpkg.com": [8.8.8.8, 1.1.1.1], 
    "+.ustclug.org": [8.8.8.8, 1.1.1.1], "+.immortalwrt.org": [8.8.8.8, 1.1.1.1], 
    "+.openwrt.org": [8.8.8.8, 1.1.1.1], "+.vsean.net": [8.8.8.8, 1.1.1.1]
  }


  # DNSæœåŠ¡å™¨é…ç½®
  # åŸºç¡€æœåŠ¡å™¨ (default-nameserver): ç”¨äºè§£æ DNS æœåŠ¡å™¨è‡ªèº«çš„åŸŸåï¼Œå¿…é¡»æ˜¯çº¯ IP åœ°å€
  default-nameserver: [119.29.29.29, tls://223.5.5.5, tls://1.12.12.12, "tls://[2402:4e00::]", "tls://[2400:3200::1]"]
  # ç›´æ¥ DNS æœåŠ¡å™¨ (direct-nameserver): ç”¨äºè§£æä¸ç»è¿‡ä»£ç†çš„åŸŸåï¼Œå¿…é¡»æ˜¯çº¯ IP åœ°å€
  direct-nameserver: [119.29.29.29, 223.5.5.5]
  # ç›´æ¥ DNS æœåŠ¡å™¨è·Ÿéšç­–ç•¥ (direct-nameserver-follow-policy): æ˜¯å¦è·Ÿéšè§„åˆ™ä¸­çš„ nameserver-policy
  direct-nameserver-follow-policy: false
  # ä»£ç†èŠ‚ç‚¹è§£ææœåŠ¡å™¨ (proxy-server-nameserver): ç”¨äºè§£æä»£ç†èŠ‚ç‚¹çš„åŸŸåï¼Œéœ€é€šè¿‡ä»£ç†è®¿é—®
  proxy-server-nameserver: [https://doh.pub/dns-query, https://dns.alidns.com/dns-query]
  # é»˜è®¤è§£ææœåŠ¡å™¨ (nameserver): å¤„ç†å¤§å¤šæ•°å¸¸è§„ DNS æŸ¥è¯¢
  nameserver: [https://doh.pub/dns-query, https://dns.alidns.com/dns-query]
  nameserver-policy: 
    # ç‰¹å®šåŸŸåçš„ DNS æœåŠ¡å™¨ç­–ç•¥
    # "+.domain.com": [dns1, dns2]: è¡¨ç¤ºåŒ¹é…ä»¥ domain.com ç»“å°¾çš„åŸŸåï¼Œä½¿ç”¨ dns1 å’Œ dns2 è§£æ
    # "domain.com": [dns1, dns2]: è¡¨ç¤ºåŒ¹é… domain.com åŸŸåï¼Œä½¿ç”¨ dns1 å’Œ dns2 è§£æ
    # æ³¨æ„ï¼šåŸŸååŒ¹é…è§„åˆ™æ”¯æŒé€šé…ç¬¦ "+"ï¼Œè¡¨ç¤ºåŒ¹é…ä»»æ„å­åŸŸå
    - 'github.com': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.github.com': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.*.github.com': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.githubusercontent.com': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.debian.org': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.yarnpkg.com"': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.ustclug.org': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.immortalwrt.org': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.openwrt.org': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    - '+.vsean.net': [tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†, tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true]
    "rule-set:private_domain,category_media_cn_domain,chinamedia_domain,usr_direct,usr_direct_torrent,cn_domain":
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
    "rule-set:usr_proxy,proxy_domain,gfw_domain":
      - tls://8.8.8.8#ğŸš€ ç¿»å¢™ä»£ç†
      - tls://1.1.1.1#ğŸš€ ç¿»å¢™ä»£ç†&h3=true


  nameserver-policy: {
    "+.github.com": [8.8.8.8, 1.1.1.1], "github.com": [8.8.8.8, 1.1.1.1], 
    "+.githubusercontent.com": [8.8.8.8, 1.1.1.1],
    "+.debian.org": [8.8.8.8, 1.1.1.1], "+.yarnpkg.com": [8.8.8.8, 1.1.1.1], 
    "+.ustclug.org": [8.8.8.8, 1.1.1.1], "+.immortalwrt.org": [8.8.8.8, 1.1.1.1], 
    "+.openwrt.org": [8.8.8.8, 1.1.1.1], "+.vsean.net": [8.8.8.8, 1.1.1.1]
  }
  default-nameserver: [223.5.5.5, 119.29.29.29, 2402:4e00::, 2400:3200::1]
  proxy-server-nameserver: [223.5.5.5, 119.29.29.29]
  nameserver: [223.5.5.5, 119.29.29.29]



  - RULE-SET,category_media_cn_domain,ğŸ¯ å›½å†…ç›´è¿
  - RULE-SET,chinamedia_domain,ğŸ¯ å›½å†…ç›´è¿
  category_media_cn_domain: { <<: *domain, url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-media-cn.mrs"}
  chinamedia_domain: { <<: *domain, url: "https://gh-proxy.com/raw.githubusercontent.com/peiyingyao/Rule-for-OCD/master/rule/Clash/ChinaMedia/ChinaMedia_OCD_Domain.mrs"}
  - RULE-SET,chinamedia_ocd_ip,ğŸ¯ å›½å†…ç›´è¿
  chinamedia_ocd_ip: { <<: *ip, url: "https://gh-proxy.com/raw.githubusercontent.com/peiyingyao/Rule-for-OCD/master/rule/Clash/ChinaMedia/ChinaMedia_OCD_IP.mrs"}


  - {name: ğŸ•¹ï¸ æ¸¸æˆç›´è¿, <<: *directmain}
  - {name: ğŸ® æ¸¸æˆä»£ç†, <<: *proxymain}
  # - RULE-SET,gamedownloadcn_ocd_domain,ğŸ•¹ï¸ æ¸¸æˆç›´è¿
  # - RULE-SET,category_games_cn_domain,ğŸ•¹ï¸ æ¸¸æˆç›´è¿
  # - RULE-SET,gamedownload_ocd_domain,ğŸ® æ¸¸æˆä»£ç†
  # - RULE-SET,category_games_domain,ğŸ® æ¸¸æˆä»£ç†
  # gamedownloadcn_ocd_domain: { <<: *domain, url: "https://gh-proxy.com/raw.githubusercontent.com/peiyingyao/Rule-for-OCD/master/rule/Clash/Game/GameDownloadCN/GameDownloadCN_OCD_Domain.mrs"}
  # category_games_cn_domain: { <<: *domain, url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-games%40cn.mrs"}
  # gamedownload_ocd_domain: { <<: *domain, url: "https://gh-proxy.com/raw.githubusercontent.com/peiyingyao/Rule-for-OCD/master/rule/Clash/Game/GameDownload/GameDownload_OCD_Domain.mrs"}
  # category_games_domain: { <<: *domain, url: "https://gh-proxy.com/raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-games.mrs"}